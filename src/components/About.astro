---
import { Image } from 'astro:assets';
import brettPhoto from '../assets/images/about/brett.jpg';
---

<section id="about" class="py-24 px-6">
    <div class="max-w-5xl mx-auto">
        <div class="grid md:grid-cols-2 gap-16 items-center">
            <div class="aspect-[4/3] overflow-hidden order-2 md:order-1" data-reveal="left">
                <Image
                    src={brettPhoto}
                    alt="Brett Seng with clients and a trophy brown trout on the river"
                    class="w-full h-full object-cover"
                    widths={[400, 800]}
                    sizes="(max-width: 768px) 100vw, 50vw"
                    quality={82}
                    format="webp"
                    loading="lazy"
                />
            </div>
            <div class="order-1 md:order-2" data-reveal="right">
                <h2 class="font-serif text-4xl md:text-5xl text-stone-900 mb-8 font-normal">
                    Outfitter/Owner<br>Brett Seng
                    <span class="accent-line"></span>
                </h2>
                <div class="space-y-5 text-stone-600 leading-relaxed">
                    <p>
                        For the past 23 years as a trout guide here in Montana's Gallatin Valley, I've carved out
                        a niche as an outfitter offering a fully customized experience built around your skill level
                        and goals for a well-rounded fly-fishing adventure in the Western Rockies.
                    </p>
                    <p>
                        From spring creeks and tailwaters to freestone rivers and mountain lakes, I build each trip
                        around what you've envisioned or researched, and I always aim to over-deliver with a few
                        fresh ideas along the way. The range of water we can explore is vast, and "Roam" is the
                        word that best captures my style as an angler continually learning and appreciating
                        the diverse fisheries of Montana.
                    </p>
                    <p>
                        At home, I'm fortunate to have the support of my wife, Ally, and our two incredible
                        children, our son Waylon and daughter Letty. Our family is at the heart of my drive for
                        a healthy work-life balance, and I feel lucky to still have genuine passion for
                        connecting guests with Montana's remarkable waters.
                    </p>
                </div>
                <div class="mt-8 pt-8 border-t border-stone-200 flex gap-8 text-sm text-stone-500">
                    <div>
                        <span class="block font-serif text-3xl text-stone-900" data-count-to="23">0</span>
                        Years Guiding
                    </div>
                    <div>
                        <span class="block font-serif text-3xl text-stone-900" data-count-to="2013">0</span>
                        Licensed Outfitter
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Mountain ridge divider transitioning to Waters section -->
<div class="mountain-divider bg-stone-50 -mb-px" data-reveal>
    <svg viewBox="0 0 1440 80" preserveAspectRatio="none" class="w-full h-12 md:h-16" aria-hidden="true">
        <!-- Dark fill below the ridge line -->
        <path d="M0,80 L0,55 Q80,38 160,42 Q240,46 320,28 Q400,10 480,22 Q560,34 640,18 Q720,2 800,20 Q880,38 960,24 Q1040,10 1120,30 Q1200,50 1280,32 Q1360,14 1440,35 L1440,80 Z"
              class="fill-stone-900" />
        <!-- Gold ridge line -->
        <path d="M0,55 Q80,38 160,42 Q240,46 320,28 Q400,10 480,22 Q560,34 640,18 Q720,2 800,20 Q880,38 960,24 Q1040,10 1120,30 Q1200,50 1280,32 Q1360,14 1440,35"
              class="ridge-line" fill="none" stroke="#c49a3c" stroke-width="1.5" />
    </svg>
</div>

<script>
    // Count-up animation for stats
    const countElements = document.querySelectorAll('[data-count-to]');

    const countObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const el = entry.target as HTMLElement;
                const target = parseInt(el.dataset.countTo || '0');
                animateCount(el, target);
                countObserver.unobserve(el);
            }
        });
    }, { threshold: 0.5 });

    countElements.forEach(el => countObserver.observe(el));

    function animateCount(el: HTMLElement, target: number) {
        const duration = target > 100 ? 1800 : 1200;
        const start = performance.now();

        function update(now: number) {
            const elapsed = now - start;
            const progress = Math.min(elapsed / duration, 1);
            // Ease out cubic
            const eased = 1 - Math.pow(1 - progress, 3);
            const current = Math.round(eased * target);
            el.textContent = String(current);

            if (progress < 1) {
                requestAnimationFrame(update);
            }
        }

        requestAnimationFrame(update);
    }
</script>
