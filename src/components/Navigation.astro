---
import { Image } from 'astro:assets';
import logo from '../assets/images/logo.png';
---

<nav id="main-nav" class="nav-bar fixed top-0 w-full z-50" aria-label="Main navigation">
    <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
        <a href={`${import.meta.env.BASE_URL}`} aria-label="Roam Outfitters home">
            <Image
                src={logo}
                alt="Roam Outfitters"
                class="h-10 w-auto invert"
                width={200}
                height={40}
                format="webp"
                loading="eager"
            />
        </a>
        <div class="hidden md:flex items-center space-x-8 text-stone-300 text-sm font-light tracking-wide">
            <a href="#about" class="hover:text-white transition">About</a>
            <a href="#waters" class="hover:text-white transition">Waters</a>
            <a href="#trips" class="hover:text-white transition">Trips</a>
            <a href="#gallery" class="hover:text-white transition">Gallery</a>
            <a href="#contact" class="hover:text-white transition">Contact</a>
        </div>
        <button
            id="mobile-menu-btn"
            class="md:hidden text-white"
            aria-label="Open navigation menu"
            aria-expanded="false"
            aria-controls="mobile-menu"
        >
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
        </button>
    </div>
    <div id="mobile-menu" class="hidden md:hidden bg-stone-950 border-t border-stone-800" role="menu">
        <div class="px-6 py-4 space-y-4 text-stone-300">
            <a href="#about" class="block hover:text-white transition" role="menuitem">About</a>
            <a href="#waters" class="block hover:text-white transition" role="menuitem">Waters</a>
            <a href="#trips" class="block hover:text-white transition" role="menuitem">Trips</a>
            <a href="#gallery" class="block hover:text-white transition" role="menuitem">Gallery</a>
            <a href="#contact" class="block hover:text-white transition" role="menuitem">Contact</a>
        </div>
    </div>
</nav>

<script>
    const nav = document.getElementById('main-nav');
    const menuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    // Nav scroll effect: transparent over hero â†’ solid when scrolled
    let ticking = false;
    function updateNav() {
        if (window.scrollY > 80) {
            nav?.classList.add('nav-scrolled');
        } else {
            nav?.classList.remove('nav-scrolled');
        }
        ticking = false;
    }

    window.addEventListener('scroll', () => {
        if (!ticking) {
            requestAnimationFrame(updateNav);
            ticking = true;
        }
    }, { passive: true });

    // Set initial state
    updateNav();

    // Mobile menu toggle
    menuBtn?.addEventListener('click', () => {
        const isOpen = !mobileMenu?.classList.contains('hidden');
        mobileMenu?.classList.toggle('hidden');
        menuBtn.setAttribute('aria-expanded', String(!isOpen));
        menuBtn.setAttribute('aria-label', isOpen ? 'Open navigation menu' : 'Close navigation menu');
    });

    mobileMenu?.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
            menuBtn?.setAttribute('aria-expanded', 'false');
            menuBtn?.setAttribute('aria-label', 'Open navigation menu');
        });
    });
</script>
